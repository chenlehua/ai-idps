# Instructions

## 需求和设计
网络入侵检测系统

基本想法
整个系统包含2部分，探针和云端服务

探针包括，探针管理程序、具体探针（当前只实现网络入侵检测探针，后续可能会扩展功能，支持防火墙探针、主机入侵检测探针）。

云端服务，包括前端和后端，只支持如下2点，不做复杂设计
1.支持规则的编辑和下发，区分版本；
2.支持接收车端上报的日志，并实时展示；

网络入侵检测探针
1、基于Suricata，需要开源合规，采用规避GPL传染的架构设计，通过进程隔离，让私有代码与GPL组件保持"井水不犯河水"的边界，避免GPL传染。
2、内置基础规则，支持规则的热更新。
3、后续可能涉及修改Suricata源码新增功能，需要支持将Suricata源码作为整个项目的一部分。

探针管理程序
支持接收云端下发的规则，并将规则下发给各探针；接收各探针的日志，并上报至云端。

环境
当前只需要支持开发环境 X86 64/ubuntu22+

技术栈
云端后台：Python（UV）/Fast API/mysql 
云端前端：Typescript/Vite/Tailwind/Shadcn
探针管理程序：C++/cmake
探针管理程序和云端通过http协议通信，数据格式为json。

按照这个想法，帮我生成详细的需求和设计文档，放在./specs/0001-spec.md 文件中, 输出为中文。

## make

请优化Makefile，将make probe-*系列命令集成到make build SERVICE=probe-manager系列命令，probe-manager支持以systemctl服务运行，支持make list查看状态。重构make list，当服务未启动、启动失败也支持查看状态;

请深度优化Makefile, 去掉测试相关命令，去掉其它不必要的命令，只包含编译、启停服务、安装卸载、查看所有服务状态、清理、查看各服务日志等功能，让用户的使用体验正好，优化完成后请执行所有这些命令，确保所有命令能正常执行。

## test

请编译启动相关服务，运行./fixtures下所有黑盒测试用例，尽最大努力修复相关缺陷。

## phase 5

请基于main分支进行开发，完成后提交至main分支，并推送到远程仓库main分支

请继续完成 Phase 5: 云端前端实现 和 Phase 6: 集成测试与优化 的任务。
先完成phase5，再进行phase6。
每完成一个阶段，进行功能验证，并修复对应缺陷，提交和推送代码。